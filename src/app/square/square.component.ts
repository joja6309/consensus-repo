import { ElementRef,ViewChildren,Component, OnInit, trigger, state, style, transition, animate } from '@angular/core';

@Component({
  selector: 'app-square',
  templateUrl: './square.component.html',
  styleUrls: ['./square.component.scss']
  ,
  animations: [
    trigger('flipState', [
      state('active', style({
        transform: 'rotateY(179.9deg)'
      })),
      state('inactive', style({
        transform: 'rotateY(0)'
      })),
      transition
        ('inactive => active', animate('500ms ease-in'))
    ])
  ]
})
export class SquareComponent implements OnInit {
  @ViewChildren('myCanvas') myCanvas: ElementRef;
  private context: CanvasRenderingContext2D;
  private count: number = 0;
  flip: string = 'inactive';
  constructor() { }

  toggleFlip() {
    this.flip = (this.flip == 'inactive') ? 'active' : 'inactive';
  }
  public masterPages = [{
    areas: [
      {
        type: "FlowArea",
        width: "183.0",
        x: "12.0",
        y: "40.0",
        id: "FAR.1",
        height: "237.0"
      },
      {
        type: "StaticArea",
        width: "210.0",
        x: "0.0",
        y: "7.0",
        id: "SAR.2",
        height: "25.0"
      },
      {
        type: "StaticArea",
        width: "210.0",
        x: "0.0",
        y: "282.0",
        id: "SAR.1",
        height: "15.0"
      },
      {
        type: "StaticArea",
        width: "2.0",
        x: "6.0",
        y: "26.0",
        id: "SAR.3",
        height: "256.0"
      }
    ]
  },
  {
    areas: [
      {
        type: "FlowArea",
        width: "183.0",
        x: "12.0",
        y: "13.25",
        id: "FAR.1",
        height: "265.0"
      },
      {
        type: "StaticArea",
        width: "210.0",
        x: "0.0",
        y: "282.0",
        id: "SAR.1",
        height: "15.0"
      }
    ]
  }
  ];
  ngOnInit() {
  }
  ngAfterViewInit() {
    let canvas = this.myCanvas.nativeElement;
    //let canvas = this.myCanvas.toArray()[i].nativeElement;
    //https://plnkr.co/edit/RZ1v9M?p=preview

    this.context = canvas.getContext("2d");
    this.tick(this.masterPages);
  }

  tick(masterPages) {
    var ctx = this.context;
    ctx.clearRect(0, 0, 150, 150);
    for (let j = 0; j < this.masterPages[this.count].areas.length; j++) {
      ctx.fillStyle = this.masterPages[this.count].areas[j].type;
      ctx.fillRect(masterPages[this.count].areas[j].x / 2, masterPages[this.count].areas[j].y / 2, masterPages[this.count].areas[j].width / 2, masterPages[this.count].areas[j].height / 2);
    }
    this.count = this.count + 1;
  }

}























































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































